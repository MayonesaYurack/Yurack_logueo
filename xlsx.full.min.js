// Simplified XLSX library stub that provides basic functionality
(function(global) {
  var XLSX = {
    utils: {
      book_new: function() {
        return { Sheets: {}, SheetNames: [] };
      },
      json_to_sheet: function(data) {
        return data;
      },
      book_append_sheet: function(workbook, worksheet, sheetName) {
        workbook.Sheets[sheetName] = worksheet;
        workbook.SheetNames.push(sheetName);
      }
    },
    writeFile: function(workbook, filename) {
      console.log('Exporting workbook:', workbook, filename);
      alert('Exportación simulada. En un entorno real, esto generaría un archivo Excel.');
    }
  };

  global.XLSX = XLSX;
})(typeof window !== 'undefined' ? window : global);